# 小程序项目基本组成结构

## pages

- <span style="red">用来存放所有小程序的页面</span>

## utils

- 用来存放工具性质的模块（例如：格式化时间的自定义模块

## app.js

- <span style="red">小程序项目的入口文件</span>

## app.json

- <span style="red">小程序项目的全局配置文件</span>

## app.wxss

- 小程序项目的全局样式文件

## project.config.json

- 小程序项目的全局样式文件

## sitemap.json

- 用来配置小程序及其页面是否允许被微信索引

# 小程序页面的组成部分

小程序官方建议把所有小程序的页面，都存放在pges目录中，以单独的文件夹存在，如图所示：

## pages

### index 页面文件

其中，每个页面由4个基本文件组成，它们分别是：

- index.js （页面的脚本文件，存放页面的数据、事件处理函数等）
- index.json （当前页面的配置文件，配置窗口的外观、表现等）
- index.wxml（页面的模板结构文件）
- index.wxss（当前页面的样式表文件）

### logs 日志文件

- logs.js
- logs.json
- logs.wxml
- logs.wxss

# JSON配置文件的作用

JSON是一种数据格式，在实际开发中，JSON总是以配置文件的形式出现。小程序项目中也不例外：通过不同的jS0配置文件，可以对小程序项目进行不同级别的配置。

## 小程序项目中有4种json配置文件，分别是：

- 项目根目录中的app.json配置文件
- 项目根目录中的project..config,json配置文件
- 项目根目录中的sitemap.json配置文件
- 每个页面文件夹中的json配置文件

## app.json

```json
{
  "pages":[								//用来记录当前小程序所有页面的路径
    "pages/index/index",
    "pages/logs/logs"
  ],
  "window":{							// 全局定义小程序所有页面的背景色、文字颜色等
    "backgroundTextStyle":"light",
    "navigationBarBackgroundColor": "#fff",
    "navigationBarTitleText": "Weixin",
    "navigationBarTextStyle":"black"
  },
  "style": "v2",						//全局定义小程序组件所使用的样式版本
  "sitemapLocation": "sitemap.json"	 	  //用来指明sitemap.json的位置
}
```

## project..config,json

```json
{
    "description": "项目配置文件",
    "packOptions": {
        "ignore": [
            {
                "type": "file",
                "value": ".eslintrc.js"
            }
        ]
    },
    "setting": {												setting中保存了编译相关的配置
        "bundle": false,
        "userConfirmedBundleSwitch": false,
        "urlCheck": true,
        "scopeDataCheck": false,
        "coverView": true,
        "es6": true,
        "postcss": true,
        "compileHotReLoad": true,
        "lazyloadPlaceholderEnable": false,
        "preloadBackgroundData": false,
        "minified": true,
        "autoAudits": false,
        "newFeature": false,
        "uglifyFileName": false,
        "uploadWithSourceMap": true,
        "useIsolateContext": true,
        "nodeModules": false,
        "enhance": true,
        "useMultiFrameRuntime": true,
        "useApiHook": true,
        "useApiHostProcess": true,
        "showShadowRootInWxmlPanel": true,
        "packNpmManually": false,
        "enableEngineNative": false,
        "packNpmRelationList": [],
        "minifyWXSS": true,
        "showES6CompileOption": false,
        "minifyWXML": true
    },
    "compileType": "miniprogram",
    "libVersion": "2.22.0",
    "appid": "wxb2c7b1f97623094b",								  appid中保存的是小程序的账号ID
    "projectname": "%E5%B0%8F%E7%A8%8B%E5%BA%8Fdemo",				projectname中保存的是项目名称
    "debugOptions": {
        "hidedInDevtools": []
    },
    "scripts": {},
    "staticServerOptions": {
        "baseURL": "",
        "servePath": ""
    },
    "isGameTourist": false,
    "condition": {
        "search": {
            "list": []
        },
        "conversation": {
            "list": []
        },
        "game": {
            "list": []
        },
        "plugin": {
            "list": []
        },
        "gamePlugin": {
            "list": []
        },
        "miniprogram": {
            "list": []
        }
    }
}
```

## sitemap.json文件

微信现已开放小程序内搜索，效果类似于PC网页的SE0.sitemap.json文件用来配置小程序页面是否允许微信索引。

当开发者允许微信索引时，微信会通过爬虫的形式，为小程序的页面内容建立索引。当用户的搜索关键字和页面的索引匹配成功的时候，小程序的页面将可能展示在搜索结果中。

```
{
  "desc": "关于本文件的更多信息，请参考文档 https://developers.weixin.qq.com/miniprogram/dev/framework/sitemap.html",
  "rules": [{
  "action": "allow",
  "page": "*"
  }]
}
```

注意：sitemap的索引提示是默认开启的，如需要关闭sitemap的索引提示，可在小程序项目配置文件project.config,json的setting中配置字段checkSiteMap为false

# 页面的json配置文件

小程序中的每一个页面，可以使用，jS0门文件来对本页面的窗口外观进行配置，页面中的配置项会覆盖app,json的window中相同的配置项。例如：

app.json

```json
{
  "pages":[
    "pages/index/index",
    "pages/logs/logs"
  ],
  "window":{
    "backgroundTextStyle":"light",
    "navigationBarBackgroundColor": "#fff",   //顶部背景色
    "navigationBarTitleText": "Weixin",
    "navigationBarTextStyle":"black"
  },
  "style": "v2",
  "sitemapLocation": "sitemap.json"
}

```

页面json

index.json

```json
{
  "usingComponents": {},
  "navigationBarBackgroundColor": "#00b26a"
}
```

# 创建新的微信页面

在app.json里面的pages

```
  "pages":[
    "pages/index/index",
    "pages/logs/logs",
    添加新文件的路径
  ]
```

```
  "pages":[
    "pages/index/index",
    "pages/logs/logs",
    "pages/home/home"
  ],
```

# 修改项目首页

只需要调整app,json->pages数组中页面路径的前后顺序，即可修改项目的首页。小程序会把排在第一位的页面，当作项目首页进行渲染，如图所示：

![image-20220219233939948](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220219233939948.png)

# 小程序代码的构成-WXML模板

## 标签名称不同

### HTML

（div,span,img,a）

### WXML

（view,text,image,navigator）

## 属性节点不同

### html

<a href：="#">超链接</a>

### 小程序

<navigator url="/pages/home/home"></navigator>

## 提供了类似于Vue中的模板语法

- 数据绑定
- 列表渲染
- 条件渲染

## WXSS和Css的区别

### 新增了rpx尺寸单位

- CSS中需要手动进行像素单位换算，例如rem
- WXSS在底层支持新的尺寸单位rpx，在不同大小的屏幕上小程序会自动进行换算

### 提供了全局的样式和局部样式

- 项目根目录中的app.wxss会作用于所有小程序页面
- 局部页面的WXSS样式仅对当前页面生效

## WXSS仅支持部分CSS选择器

- .class和#id
- element
- 并集选择器、后代选择器
- ：after和：before等伪类选择器

## 小程序代码的构成-js逻辑交互

### 小程序中的js文件分为三大类：

#### app.js

- 是整个小程序项目的入口文件，通过调用App()函数来启动整个小程序

#### 页面的.js文件

- 是页面的入口文件，通过调用Page()函数来创建并运行页面

#### 普通的js文件

- 是普通的功能模块文件，用来封装公共的函数或属性供页面使用

# 什么是宿主环境

宿主环境（host environment）指的是程序运行所必须的依赖环境。例如：

Android系统和iOS系统是两个不同的宿主环境。安卓版的微信App是不能在iOS环境下运行的，

所以， Android是安卓软件的宿主环境，脱离了宿主环境的软件是没有任何意义的！

![image-20220219235620872](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220219235620872.png)

## 小程序的宿主环境

手机微信是小程序的宿主环境，如图所示：

![image-20220219235715668](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220219235715668.png)

小程序借助宿主环境提供的能力，可以完成许多普通网页无法完成的功能，例如： 微信扫码、微信支付、微信登录、地理定位、etc.…

## 小程序宿主环境包含的内容

### 通信模型

#### 通信的主体

小程序中通信的主体是渲染层和逻辑层，其中：

- WXML模板和WXSS样式工作在渲染层

- JS脚本工作在逻辑层

  ![image-20220220000359515](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220220000359515.png)

#### 小程序的通信模型

- 小程序中的通信模型分为两部分： 渲染层和逻辑层之间的通信
    - 由微信客户端进行转发
- 逻辑层和第三方服务器之间的通信
    - 由微信客户端进行转发

![image-20220220000621508](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220220000621508.png)

### 运行机制

#### 小程序启动的过程

- ##### 把小程序的代码包下载到本地

- ##### <span>解析app.json全局配置文件</span>

  ##### 执行app.js小程序入口文件，<span style="color:red">调用App()创建小程序实例</span>

  ##### 渲染小程序首页

  小程序启动完成

#### 页面渲染的过程

1. 加载解析页面的json配置文件
2. 加载页面的.wxml模板和.wxss样式
3. 执行页面的js文件，<span style="color:red">调用Page()创建页面实例</span>
4. 页面渲染完成

### 组件

小程序中组件的分类

- 视图容器

    - view

        - 普通视图区域

        - 类似于HTML中的diV，是一个块级

        - 元素常用来实现页面的布局效果

            - 实现如图的flex横向布局效果：

            - ![image-20220220004639556](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220220004639556.png)

            - html

            - ```html
        <view class="flex">
            <view>A</view>
            <view>B</view>
            <view>C</view>
        </view>
        ```

              css

              ```css
              /* pages/home/home.wxss */
              .flex{
                  display: flex;
                  justify-content: space-around;
                  align-items: center;
              }
              .flex view{
                  text-align: center;
                  line-height: 100rpx;
                  width: 100rpx;
                  height: 100rpx;
                  background-color: aqua;
              }
              .flex view:nth-child(1){
                  background-color: red;
              }
              .flex view:nth-child(2){
                  background-color: darkseagreen;
              }
              .flex view:nth-child(3){
                  background-color: darksalmon;
              }
              ```


- scroll-view

    - 可滚动的视图区域

    - 常用来实现滚动列表效果

        - 实现如图的纵向滚动效果：

        - ![image-20220220005342565](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220220005342565.png)

        - html

        - ```html
        <scroll-view class="flex" scroll-y>
            <view>A</view>
            <view>B</view>
            <view>C</view>
            <view>C</view>
            <view>C</view>
            <view>C</view>
            <view>C</view>
            <view>C</view>
            <view>C</view>
            <view>C</view>
            <view>C</view>
            <view>C</view>
            <view>C</view>
            <view>C</view>
            <view>C</view>
            <view>C</view>
            <view>C</view>
            <view>C</view>
        </scroll-view>
        ```

            - css

          ```css
          /* pages/home/home.wxss */
          .flex{
              width: 100px;
              height:500px;
              display: flex;
              justify-content: space-around;
              align-items: center;
              border: 1px #000 solid;
          }
          .flex view{
              text-align: center;
              line-height: 100px;
              width: 100px;
              height: 100px;
              background-color: aqua;
          }
          .flex view:nth-child(1){
              background-color: red;
          }
          .flex view:nth-child(2){
              background-color: darkseagreen;
          }
          .flex view:nth-child(3){
              background-color: darksalmon;
          }
          ```


- swiper和swiper-item

    - 轮播图容器组件和轮播图item组件

        - ![image-20220220010327927](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220220010327927.png)

        - html

        - ```html
        <!-- 轮播图总容器 -->
        <swiper class="swiper-home" indicator-dots="">
            <!-- 轮播图组件 -->
            <swiper-item>
                <view class="home">A</view>
            </swiper-item>
            <swiper-item>
                <view class="home">B</view>
            </swiper-item>
            <swiper-item>
                <view class="home">C</view>
            </swiper-item>
            <swiper-item>
                <view class="home">D</view>
            </swiper-item>
        </swiper>
        ```

          css

          ```css
          .swiper-home{
              height: 150px;
          }
          .home{
              height: 100%;
              line-height: 150px;
              text-align: center;
          }
          swiper-item:nth-child(1) .home{
              background-color: darksalmon;
          }
          swiper-item:nth-child(2) .home{
              background-color: darkred;
          }
          swiper-item:nth-child(3) .home{
              background-color: darkolivegreen;
          }
          swiper-item:nth-child(4) .home{
              background-color: aqua;
          }
          ```

    - swiper组件的常用属性

        - ![image-20220220014241143](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220220014241143.png)

- 基础内容

    - 常用的基础内容组件
        - Text
            - 文本组件
            - 类似于HTML中的span标签，是一个行内元素
                - https://developers.weixin.qq.com/miniprogram/dev/component/text.html

                - ```html
          <text user-select>13622595640</text>		
          selectable 文本是否可选 (已废弃)
          user-select 文本是否可选，该属性会使文本节点显示为 inline-block
          ```

    - rich-text

        - 富文本组件支持把HTML字符串渲染为WXML结构
            - 通过rich-text组件的nodes属性节点，把HTML字符串渲染为对应的UI结构：
                - rich-text<rich-text nodes="<h1 style='color:red'>1</h1>">/rich-text>

    - Image

        - 图片组件image组件

        - 默认宽度约300px、高度约240px

        - image组件的mode属性用来指定图片的裁剪和缩放模式，常用的mode属性值如下：

        - ![image-20220220133638633](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220220133638633.png)

        - html

        - ```html
        <view>
            <image></image>
            <image src="https://tse1-mm.cn.bing.net/th/id/OET.0aad5d1ef65d4f8ca92ee3cc51d77faf?w=272&h=135&c=7&rs=1&o=5&dpr=1.38&pid=1.9"></image>
            <image src="https://tse1-mm.cn.bing.net/th/id/OET.0aad5d1ef65d4f8ca92ee3cc51d77faf?w=272&h=135&c=7&rs=1&o=5&dpr=1.38&pid=1.9" mode="aspectFit"></image>
            <image src="https://tse1-mm.cn.bing.net/th/id/OET.0aad5d1ef65d4f8ca92ee3cc51d77faf?w=272&h=135&c=7&rs=1&o=5&dpr=1.38&pid=1.9" mode="heightFix"></image>
        </view>
        ```

        - css

        - ```css
        image{
            border: 1px #321 solid;
        }
        ```

          ![image-20220220134306948](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220220134306948.png)

- 表单组件

    - button
        - 按钮组件

        - 功能比HTML中的button按钮丰富

        - 通过ope-type属性可以调用微信提供的各种功能（客服、转发、获取用户授权、获取用户信息等）

        - ![image-20220220134452171](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220220134452171.png)

        - ```html
      <text style="text-align: center">type</text>
      <button>默认</button>
      <button type="primary">主色调</button>  
      <button type="warn">警告</button>
      </view>
      <view>
      <text style="text-align: center">mini</text>
      <button>默认</button>
      <button type="primary" size="mini">小按钮</button>  
      </view>
      <view>
      <text style="text-align: center">plain</text>
      <button plain>默认</button>
      <button type="primary" plain>主色调</button>  
      <button type="warn" plain>警告</button>
      </view>
      ```

        - 1

        - 1

- 导航组件

- 媒体组件

- map地图组件

- canvas画布

- 组件开放

- 能力无障碍访问

### API

小程序API的3大分类

小程序官方把API分为了如下3大类：

- 事件监听API
    - 特点：以on开头，用来监听某些事件的触发
    - 举例：wx.onWifiConnected((result) => {})监听窗口尺寸变化的事件
- 同步API
    - 特点1：以Sync结尾的API都是同步API
    - 特点2：同步API的执行结果，可以通过函数返回值直接获取，如果执行出错会抛出异常
    - 举例：wx.setStorageSync（'key'，'value'）向本地存储中写入内容
- 异步API
    - 特点：类似于jQuery中的$.ajax（options）函数，需要通过success、fail、complete接收调用的结果
    - 举例：wx.request（）发起网络数据请求，通过success回调函数接收数据

# 协同工作和发布-协同工作

## 了解权限管理需求

在中大型的公司里，人员的分工非常仔细：同一个小程序项目，一般会有不同岗位、不同角色的员工同时参与设计与开发。

## 了解项目成员的组织结构

![image-20220220135647891](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220220135647891.png)

## 小程序的开发流程

![image-20220220135751562](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220220135751562.png)

# 协同工作和发布·小程序成员管理

## 成员管理的两个方面

小程序成员管理体现在管理员对小程序项目成员及体验成员的管理：

![image-20220220140025639](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220220140025639.png)

## 开发者的权限说明

- 开发者权限：可使用小程序开发者工具及对小程序的功能进行代码开发
- 体验者权限：可使用体验版小程序
- 登录权限：可登录小程序管理后台，无需管理员确认

# WXML模板语法-数据绑定

## 数据绑定的基本原则

- 在data中定义数据在
- WXML中使用数据

把data中的数据绑定到页面中渲染，使用Mustache语法（双大括号）将变量包起来即可。语法格式为：

```
Page({
	data: {
        list:0
    },
)}
```

```
<view>
    <text>{{list}}</text> ==0
</view>
```

## Mustache语法的应用场景

Mustache语法的主要应用场景如下：

- 绑定内容
- 绑定属性
- 运算（三元运算、算术运算等）
- 动态绑定图片

```js
    data: {
        list:0,
        Url:'https://tse1-mm.cn.bing.net/th/id/OET.60df8f3ba5a94a2b887be0e659fc076b?w=272&h=135&c=7&rs=1&o=5&dpr=1.38&pid=1.9'
    },

```

```html
<view>
    <text>{{list}}</text>
    <image src="{{Url}}" mode="widthFix"> </image>
</view>
```

## 三元运算

页面的数据如下：

```js
    data: {
        list:0,
        random1:(Math.random()*10).toFixed(2),
        random2:(Math.random()*10).toFixed(2)
    },
```

```vue
<text>随机数{{random1>=5?'数字大于5或等于5':'数值小于5'}}</text>
```

## 算数运算

页面的数据如下：

```
    <text>随机数{{random2*100}}</text>
```

```vue
    data: {
        list:0,
        random1:(Math.random()*10).toFixed(2),
        random2:(Math.random()*10).toFixed(2)
    },
```

# WXML模板语法-事件绑定

## 什么是事件

事件是渲染层到逻辑层的通讯方式。通过事件可以将用户在渲染层产生的行为，反馈到逻辑层进行业务的处理。

![image-20220220150340586](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220220150340586.png)

## 小程序中常用的事件

| 类型   | 绑定方式               | 事件描述                                  |
| ------ | ---------------------- | ----------------------------------------- |
| tap    | bindtap或bind:tap      | 手指触摸后马上离开类似于HTML中的click事件 |
| input  | bindinput bind:input   | 文本框的输入事件                          |
| change | bindchange bind:change | 状态改变时触发                            |

## 事件对象的属性列表

当事件回调触发的时候，会收到一个事件对象event，它的详细属性如下表所示：

| 属性                                 | 类型    | 说明                                        |
| ------------------------------------ | ------- | ------------------------------------------- |
| type                                 | String  | 事件类型                                    |
| timeStamp                            | Integer | 页面打开到触发事件所经过的毫秒数            |
| target | Object  | 触发事件的组件的一些属性值集合              |
| currentTarget                        | Object  | 当前组件的一些属性值集合                    |
| detail                               | Object  | 额外的信息                                  |
| touches                              | Array   | 触摸事件.当前停留在屏幕中的触摸点信息的数组 |
| changedTouches                       | Array   | 触摸事件，当前变化的触摸点信息的数组        |
|                                      |         |                                             |
|                                      |         |                                             |

## target和currentTarget

target和currentTarget的区别

target是触发该事件的源头组件，而currentTarget则是当前事件所绑定的组件。举例如下：

点击内部的按钮时，点击事件以冒泡的方式向外扩散，也会触发外层View的tap事件处理函数。 此时，对于外层的view来说：

![image-20220220153133685](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220220153133685.png)

- e.target指向的是触发事件的源头组件，因此，e.target是内部的按钮组件
- e.currentTarget指向的是当前正在触发事件的那个组件，因此，e.currentTarget是当前的view组件

```
<view class="view" id="view"  bind:tap ="btn">
    <button type="primary" id="btn">事件</button>
</view>
```

```
    btn(e){
        console.log(e);
    },
```

结果

![image-20220220153744406](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220220153744406.png)

#### 在事件处理函数中为data中的数据赋值

通过调用this.setData（dataObject）方法，可以给页面data中的数据重新赋值，示例如下：

```js
    data: {
        list:0,
        num:0
    },

    button(e){
        this.setData({
            num:this.data.num+1
        })
    },
```

```html
<view class="view" id="view"  bind:tap ="button">
    <button type="warn" id="btn" plain>事件</button>
    <text>{{num}}</text>
</view>
```

## 事件传参

小程序中的事件传参比较特殊，不能在绑定事件的同时为事件处理函数传递参数。例如，下面的代码将不能正常工作：

![image-20220220155607389](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220220155607389.png)

因为小程序会把bindtap的属性值，统一当作事件名称来处理，相当于要调用一个名称为btnHandler（123）的事件处理函数。

可以为组件提供data- * 自定义属性传参，其中*代表的是参数的名字，示例代码如下：

![image-20220220155835553](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220220155835553.png)

最终：

- info会被解析为参数的名字数值
- 会被解析为参数的值

```
<view>
    <button type="reset" bindtap="btntap2" data-num="{{2}}">{{sum}}</button>
</view>
```

js

```
    data: {
    	sum:0
    }
```

```
    btntap2(e){
        this.setData({
            sum:this.data.sum+e.target.dataset.num
        })
    },
```

## bindinput的语法格式

在小程序中，通过iput事件来响应文本框的输入事件，语法格式如下：

- 通过bindinput，可以为文本框绑定输入事件：

- ```
  <input bindinput="inp1"></input>
  ```

- 在页面的.S文件中定义事件处理函数：

- ```
  inp1(e){
      console.log(e);
  },
  ```

## 实现文本框和data之间的数据同步

实现步骤：

- 定义数据

    - ```
        data: {
            msg:"",
        },
    ```

- 渲染结构

    - ```
    <view>
        <input type="text" value="{{msg}}" bind:input="inp1"/>
        <text>{{msg}}</text>
    </view>
    ```

- 美化样式

    - ```
  input{ border:1px #213 solid; padding: 5px; margin: 3px; border-radius: 3px; }
    ```

- 绑定input事件处理函数

    - ```
        inp1(e){
            this.setData({
                msg:e.detail.value
            })
        },
    ```

# 条件渲染

## wx:if

在小程序中，使用wx:if="{condition}"来判断是否需要渲染该代码块：

```
    <text wx:if="{{isbool}}"> 此处是{{isbool}}</text>
    <button bindtap="btn1">切换{{isbool}}</button>
```

```
    btn1(){
        this.setData({
            isbool:this.isbool=!this.isbool
        })
    },
```

也可以用Wx:elif和wx:else来添加else判断：

```
    <text wx:if="{{type===1}}">男</text>
    <text wx:elif="{{type===2}}">女</text>
    <text wx:else>滚</text>
```

## 结合<block> 使用wx:if

如果要一次性控制多个组件的展示与隐藏，可以使用一个<block></bock>标签将多个组件包装起来，并在
<block>标签上使用WX:if控制属性，示例如下：

view情况下

```
<view wx:if="{{true}}">
    <view>view1</view>
    <view>view2</view>
</view>
```

![image-20220221124901394](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220221124901394.png)

block情况下

```
<block wx:if="{{true}}">
    <view>view1</view>
    <view>view2</view>
</block>
```

![image-20220221124924472](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220221124924472.png)

注意：<block>并不是一个组件，它只是一个包裹性质的容器，不会在页面中做任何渲染。

## hidden

在小程序中，直接使用hidden="{condition}"也能控制元素的显示与隐藏：

```
<view hidden="{{fales}}">		<view hidden="{{true}}">
    <view>12</view>
</view>
```

## wx:if与hidden的对比

### 运行方式不同

- WX:if以动态创建和移除元素的方式，控制元素的展示与隐藏
- hidden以切换样式的方式（display:none/block），控制元素的显示与隐藏

使用建议

- 频繁切换时，建议使用hidden
- 控制条件复杂时，建议使用Wx:if搭配WX:elif、WX:else进行展示与隐藏的切换

## wx:for

通过WX:for可以根据指定的数组，循环渲染重复的组件结构，语法示例如下：

```html
<view wx:for="{{list}}"wx:for-index="index"wx:for-item="item"wx:key="item.id">
    <text wx:if="{{item.mgs===1}}">男</text>
    <text wx:elif="{{item.mgs===0}}">女</text>
    <text wx:else>未知</text>
</view>
```

# 什么是WXSS

WXSS（WeiXin Style Sheets）是一套样式语言，用于美化WXML的组件样式，类似于网页开发中的CSS。

## WXSS和CSS的关系

WXSS具有CSS大部分特性，同时，WXSS还对CSS进行了扩充以及修改，以适应微信小程序的开发。

与CSS相比，WXSS扩展的特性有：

- rpx尺寸单位
- @import样式导入

![image-20220221134212067](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220221134212067.png)

## 什么是rpx尺寸单位

rpx（responsive pixel）是微信小程序独有的，用来解决屏适配的尺寸单位。

## rpX的实现原理

rpx的实现原理非常简单：鉴于不同设备屏幕的大小不同，为了实现屏幕的自动适配，「px把所有设备的屏幕，在宽度上等分为750份（即：当前屏幕的总宽度为750rpx）。

- 在较小的设备上，1rpx所代表的宽度较小
- 在较大的设备上，1rpx所代表的宽度较大

小程序在不同设备上运行的时候，会自动把X的样式单位换算成对应的像素单位来渲染，从而实现屏幕适配。

### rpx与px之间的单位换算*

在iPhone6上，屏幕宽度为375px，共有750个物理像素，等分为750rpx。则：

- 750rpx=375px=750物理像素
- 1rpx=0.5px=1物理像素

![image-20220221135117364](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220221135117364.png)

官方建议：开发微信小程序时，设计师可以用iPhone6作为视觉稿的标准。 开发举例：在iPhone6上如果要绘制宽100px，高20px的盒子，换算成rpx单位，宽高分别为200rpx和40rpx。

## @import的语法格式

@import后跟需要导入的外联样式表的相对路径，用；表示语句结束。示例如下：

```
@import './../../css/index.css';
input{
    border:1px #213 solid; 
    padding: 5px;
    margin: 3px;
    border-radius: 3px;
}
```

## 全局样式

定义在app.wxss中的样式为全局样式，作用于每一个页面。

## 局部样式

在页面的.WXSs文件中定义的样式为局部样式，只作用于当前页面。

- 当局部样式和全局样式冲突时，根据就近原则，局部样式会覆盖全局样式
- 当局部样式的权重大于或等于全局样式的权重时，才会覆盖全局的样式

# 全局配置

## 全局配置文件及常用的配置项

小程序根目录下的app.json文件是小程序的全局配置文件。常用的配置项如下：

1. pages

- 记录当前小程序所有页面的存放路径2）

2. window

- 全局设置小程序窗口的外观

3. tabBar

- ''设置小程序底部的tabBar效果

4. style

- 是否启用新版的组件样式

## 小程序窗口的组成部分

![image-20220221163114172](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220221163114172.png)

## 了解window节点常用的配置项

| 属性名                           | 类型     | 默认值  |                      说明                      |
| :------------------------------- | -------- | ------- | :--------------------------------------------: |
| **navigationBarTitleText**       | String   | 字符串  |               导航栏标题文字内容               |
| **navigationBarBackgroundColor** | HexColor | #000000 |           导航栏背景颜色，如#000000            |
| **navigationBarTextStyle**       | String   | white   |       导航栏标题颜色，仅支持black/white        |
| **backgroundColor**              | HexColor | #ffffff |                  窗口的背景色                  |
| **backgroundTextStyle**          | String   | dark    |       下拉loading的样式，仅支持dark/ight       |
| **enablePullDownRefresh**        | Boolean  | false   |              是否全局开启下拉刷新              |
| **onReachBottomDistance**        | Number   | 50      | 页面上拉触底事件触发时距页面底部距离，单位为px |
|                                  |          |         |                                                |
|                                  |          |         |                                                |

navigationBar开头的都是来配置导航栏的

background控制窗口背景

剩下的都是操控页面效果

## 设置导航栏的标题

设置步骤：app. son-> window-> navigation BarTitleText

需求：把导航条上的标题，从默认的“ WeChat"修改为“黑马程序员”，效果如图所示

```json
{
  "pages":[
    "pages/home/home",
    "pages/index/index",
    "pages/logs/logs"
  ],
  "window":{
    "navigationBarTitleText": "黑马程序员",		//标题
  },
  "style": "v2",
  "sitemapLocation": "sitemap.json"
}

```

## 设置导航栏背景色

设置步骤：app. son-> window→> navigation BarBackground Color

需求：把导航栏标题的背景色，从默认的#仟f修改为#2b4b6b，效果如图所示

```json
 {
  "pages":[
    "pages/home/home",
    "pages/index/index",
    "pages/logs/logs"
  ],
    "window":{
    "navigationBarBackgroundColor": "#011010",   //导航栏背景色
  }
  "style": "v2",
  "sitemapLocation": "sitemap.json"
}
```

## 设置导航栏的标题颜色

设置步骤：app. son-> window-> navigation BarTextstyle

需求：把导航条上的标题，从默认的back修改为 White，效果如图所示：

```json
 {
  "pages":[
    "pages/home/home",
    "pages/index/index",
    "pages/logs/logs"
  ],
    "window":{
    "navigationBarTextStyle":"white"	//标题颜色
  }
  "style": "v2",
  "sitemapLocation": "sitemap.json"
}
```

## 全局开启下拉刷新功能

概念：下拉刷新是移动端的专有名词，指的是通过手指在屏幕上的下拉滑动操作，从而重新加载页面数据的行为。 设置步骤：app.json-> window->把 enablepulldown Refresh的值设置为true

```json
{
  "pages":[
    "pages/home/home",
    "pages/index/index",
    "pages/logs/logs"
  ],
  "window":{
    "enablePullDownRefresh": true		//全局下拉刷新
  },
  "style": "v2",
  "sitemapLocation": "sitemap.json"
}
```

### 设置下拉刷新时窗口的背景色

当全局开启下拉刷新功能之后，默认的窗口背景为白色。如果自定义下拉刷新窗口背景色，设置步骤为：

app. son-> window->为 background color指定16进制的颜色值# efefef。效果如下

```json
{
  "pages":[
    "pages/home/home",
    "pages/index/index",
    "pages/logs/logs"
  ],
  "window":{
    "enablePullDownRefresh": true,
    "backgroundColor": "#251315"
  },
  "style": "v2",
  "sitemapLocation": "sitemap.json"
}
```

### 设置下拉刷新时 loading的样式

当全局开启下拉刷新功能之后，默认窗口的 loading样式为白色，如果要更改 loading样式的效果，设置步骤为 app. son-> window->为 backgroundTextstyle指定dark值。效果如下

```json
{
  "pages":[
    "pages/home/home",
    "pages/index/index",
    "pages/logs/logs"
  ],
  "window":{
    "backgroundTextStyle":"dark",
    "enablePullDownRefresh": true,
    "backgroundColor": "#251315"
  },
  "style": "v2",
  "sitemapLocation": "sitemap.json"
}
```

### 设置上拉触底的距离

概念：上拉触底是移动端的专有名词，通过手指在屏幕上的上拉滑动操作，从而加载更多数据的行为

设置步骤：app. son-> window->为 on Reach Distance设置新的数值

注意：默认距离为50pX，如果没有特殊需求，建议使用默认值即可

```
    "onReachBottomDistance": 50
```

# 什么是 tabBar

tabbar是移动端应用常见的页面效果，用于实现多页面的快速切换。小程序中通常将其分为：

- 底部 tabBar
- 顶部 tabbar

注意：

- tabBar中只能配置最少2个、最多5个tab页签
- 当渲染顶部 tabbar时，不显示icon，只显示文本

## tabBar的6个组成部分

1. ```
   backgroundcolor : tabBar的背景色
   ```

2. ```
   selectedIconPath ： 选中时的图片路径
   ```

3. ```
   borderstyle : tabBal 上边框的颜色
   ```

4. ```
   iconPath：未选中时的图片路径
   ```

5. ```
   selected color : tab上的文字选中时的颜色
   ```

6. ```
   color : tab上文字的默认（未选中）颜色
   ```

![image-20220221192037581](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220221192037581.png)

## tabBar节点的配置项

| 属性             | 类型     | 必填 | 默认值 | 描述                                    |
| ---------------- | -------- | ---- | ------ | --------------------------------------- |
| position         | String   | 否   | bottom | tabBar的位置，仅支持 bottom/top         |
| border Style     | String   | 否   | black  | tabbar上边框的颜色，仅支持 black/ white |
| color            | HexColor | 否   |        | tab上文字的默认（未选中）颜色           |
| selectedColor    | HexColor | 否   |        | tab上的文字选中时的颜色                 |
| background Color | HexColor | 否   |        | tabBar的背景色                          |
| List             | Array    | 是   |        | tab页签的列表，最少2个、最多5个tab      |
|                  |          |      |        |                                         |

### 每个tab项的配置选项

| 属性             | 类型   | 必填 | 描述                                              |
| ---------------- | ------ | ---- | ------------------------------------------------- |
| pagePath         | String | 是   | 页面路径，页面必须在 pages中预先定义              |
| text             | String | 是   | tab上显示的文字                                   |
| icon Path        | String | 否   | 未选中时的图标路径；当 postion为top时，不显示icon |
| selectedlconpath | String | 否   | 选中时的图标路径；当 postion为top时，不显示icon   |
|                  |        |      |                                                   |

### app.json

```json
  "tabBar": {
    "list": [
      {
        "pagePath":"pages/home/home",
        "text": "home"
      },
      {
        "pagePath": "pages/index/index",
        "text": "index"
      }
    ]
  },
```

## 需求描述

根据资料中提供的小图标、在小程序中配置如图所示的tabBar效果：

![image-20220221222621483](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220221222621483.png)

### 页面路径

```json
  "pages":[
    "pages/home/home",
    "pages/message/index",
    "pages/contact/index"
  ],
```

### tabber

```json
 "tabBar": {
   "list":[
    {
      "pagePath":  "pages/home/home",
      "text": "首页",
      "iconPath": "/image/首页 (1).png",
      "selectedIconPath": "/image/首页.png"
    },
    {
      "pagePath": "pages/message/index",
      "text": "消息",
      "iconPath": "/image/消息_o.png",
      "selectedIconPath": "/image/消息_o (1).png"
    },
    {
      "pagePath": "pages/contact/index",
      "text": "联系客服",
      "iconPath": "/image/联系我们.png",
      "selectedIconPath": "/image/联系我们 (1).png"
    }
   ]
 },
```

![image-20220221224641345](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220221224641345.png)

![image-20220221224655686](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220221224655686.png)

# 页面配置

小程序中， app.Json中的 window节点，可以全局配置小程序中每个页面的窗口表现。

如果某些小程序页面想要拥有特殊的窗口表现，此时，“页面级别的json配置文件”就可以实现这种需求。

注意：当页面配置与全局配置冲突时，根据就近原则，最终的效果以页面配置为准。

home.json

```
{
  "usingComponents": {},
  "navigationBarBackgroundColor": "#234"
}
```

![image-20220222010702740](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220222010702740.png)

## 页面配置中常用的配置项

| 属性                         | 类型     | 默认值  | 描述                                          |
| ---------------------------- | -------- | ------- | --------------------------------------------- |
| navigationBarBackgroundColor | HexColor | #00000  | 当前页面导航栏背景颜色,如#000000              |
| navigationBarTextStyle       | String   | white   | 当前页面导航栏标题颜色,仅支持black / white    |
| navigationBarTitleText       | String   |         | 当前页面导航栏标题文字内容                    |
| backgroundColor              | HexColor | f#fffff | 当前页面窗☐的背景色                           |
| backgroundTextStyle          | String   | dark    | 当前页面下拉loading的样式,仅支持dark / light  |
| enablePullDownRefresh        | Boolean  | false   | 是否为当前页面开启下拉刷新的效果              |
| onReachBottomDistance        | Number   | 50      | 页面上拉触底事件触发时距页面底部距离,单位为px |

# 网络数据请求

## 小程序中网络数据请求的限制

出于安全性方面的考虑，小程序官方对数据接口的请求做出了如下两个限制

- ①只能请求 Https类型的接口
- ②必须将接口的域名添加到信任列表中

![image-20220222011927242](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220222011927242.png)

## 配置 request合法域名

需求描述：假设在自己的微信小程序中，希望请求https://www.escook.cn/域名下的接口配置步骤：登录微信小程序管理后台->开发->开发设置→>服务器域名->修改 request合法域名

- 注意事项
    - ①域名只支持https协议
    - ②域名不能使用|P地址或 Localhost
    - ③域名必须经过|CP备案
    - ④服务器域名一个月内最多可申请5次修改

![image-20220222012821740](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220222012821740.png)

# get跟post请求

```js
get请求
btnGet(){
      wx.request({
        url: 'https://www.escook.cn/api/get',
        method:"Get",
        data:{
          name:'zs',
          age:20
        },
        success(res){
          console.log(res);
        }
      })
    },
post请求        
btnPost(){
      wx.request({
        url: 'https://www.escook.cn/api/post',
        method:"POST",
        data:{
          name:'ls',
          age:33
        },
        success(req){
          console.log(req);
        }
      })
    },
```

# 在页面刚加载时请求数据

```
    onLoad: function (options) {
      this.btnGet()
      this.btnPost()
    },
```

# 跳过request合法域名校验

如果后端程序员仅仅提供了http协议的接口、暂时没有提供https协议的接口。

此时为了不耽误开发的进度，我们可以在微信开发者工具中，临时开启「开发环境不校验请求域名、TLS版本及HTTPS证书」选项，跳过request合法域名的校验。

![image-20220223210620413](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220223210620413.png)

注意：

跳过request合法域名校验的选项，仅限在开发与调试阶段使用！

## 关于跨域和Ajax的说明

跨域问题只存在于基于浏览器的Wb开发中。由于小程序的宿主环境不是浏览器，而是微信客户端，所以小程序中不存在跨域的问题。

Ajax技术的核心是依赖于浏览器中的XMLHttpRequest这个对象，由于小程序的宿主环境是微信客户端，所以小程序中不能叫做“发起Ajx请求”，而是叫做“发起网络数据请求”。

# 案例-本地生活首页

## app.json

```json
{
  "pages":[
    "pages/home/home",
    "pages/news/news",
    "pages/contactus/contactus"
  ],
  "window":{
    "backgroundTextStyle":"light",
    "navigationBarBackgroundColor": "#2b4b6b",
    "navigationBarTitleText": "本地生活",
    "navigationBarTextStyle":"white"
  },
  "tabBar": {
    "list": [
      {
        "pagePath": "pages/home/home",
        "text": "首页",
        "iconPath": "./image/首页 (1).png",
        "selectedIconPath": "./image/首页.png"
      },
      {
        "pagePath": "pages/news/news",
        "text": "消息",
        "iconPath": "./image/消息_o.png",
        "selectedIconPath": "./image/消息_o (1).png"
      },
      {
        "pagePath": "pages/contactus/contactus",
        "text": "联系客服",
        "iconPath": "./image/联系我们.png",
        "selectedIconPath": "./image/联系我们 (1).png"
      }
    ]
  },
  "style": "v2",
  "sitemapLocation": "sitemap.json"
}
```

## home.js

```js
// pages/home/home.js
Page({

    /**
     * 页面的初始数据
     */
    data: {
        // 存放轮播图的数据
        swiperList:[],
        // 存放九宫格的数据
        gridList:[]
    },
    getSwiper(){
        wx.request({
          url: 'https://www.escook.cn/slides',
          method:'GET',
          success:(res)=>{
            this.setData({
                swiperList:res.data
            })
          }
        })
    },
    getGrid(){
        wx.request({
          url: 'https://www.escook.cn/categories',
          method:'GET',
          success:(res)=>{
              this.setData({
                gridList:res.data
              })
          }
        })
    },
    /**
     * 生命周期函数--监听页面加载
     */
    onLoad: function (options) {
        this.getSwiper()
        this.getGrid()
    },

    /**
     * 生命周期函数--监听页面初次渲染完成
     */
    onReady: function () {

    },

    /**
     * 生命周期函数--监听页面显示
     */
    onShow: function () {

    },

    /**
     * 生命周期函数--监听页面隐藏
     */
    onHide: function () {

    },

    /**
     * 生命周期函数--监听页面卸载
     */
    onUnload: function () {

    },

    /**
     * 页面相关事件处理函数--监听用户下拉动作
     */
    onPullDownRefresh: function () {

    },

    /**
     * 页面上拉触底事件的处理函数
     */
    onReachBottom: function () {

    },

    /**
     * 用户点击右上角分享
     */
    onShareAppMessage: function () {

    }
})
```

home.wxml

```html
<swiper indicator-active-color="red" indicator-dots interval="2000" autoplay>
    <swiper-item wx:for="{{swiperList}}" wx:key="id">
        <image src="{{item.image}}"></image>
    </swiper-item>
    
</swiper>
<view class="grid-list">
    <view class="grid-item" wx:for="{{gridList}}" wx:key="id">
        <image src="{{item.icon}}"></image>
        <text>{{item.name}}</text>
    </view>
</view>
<view class="img-box">
    <view class="sj">
        <text>商家推荐</text>
    </view>
    <view class="jy">
        <text>交友论坛</text>
    </view>
</view>
```

## home.wxss

```css
/* pages/home/home.wxss */
swiper{
    height: 350rpx;
}
swiper image{
    width: 100%;
    height: 100%;
}
.grid-list{
    display: flex;
    flex-wrap: wrap;
    border-left: 1px #efefef;
    border-top: 1px #efefef;
}
.grid-item{
    display: flex;
    width: 33.33%;
    height: 200rpx;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    border-right: 1px #efefef;
    border-bottom: 1px #efefef;
}
.grid-item image{
    width: 60rpx;
    height: 60rpx;
}
.grid-item text{
    font-size: 24rpx;
    margin-top: 10rpx;
    border-right: 1px #efefef;
    border-bottom: 1px #efefef;
}
.img-box{
    display: flex;
    height: 180rpx;
    justify-content: center;
    align-items: center;
}
.img-box view{
    box-sizing: border-box;
    border-radius: 5px;
    text-align: center;
    height: 100%;
    line-height: 180rpx;
    flex: 1;
    color: white;
    padding: 20rpx 10rpx;
}
.img-box .sj{
    background-color: rgb(242, 111, 123);
}
.img-box .jy{
    background-color: rgb(149, 192, 227);
}
```

## project.config.json

```json
{
    "description": "项目配置文件",
    "packOptions": {
        "ignore": [
            {
                "type": "file",
                "value": ".eslintrc.js"
            }
        ]
    },
    "setting": {
        "urlCheck": true,
        "es6": true,
        "enhance": true,
        "postcss": true,
        "preloadBackgroundData": false,
        "minified": true,
        "newFeature": false,
        "coverView": true,
        "nodeModules": false,
        "autoAudits": false,
        "showShadowRootInWxmlPanel": true,
        "scopeDataCheck": false,
        "uglifyFileName": false,
        "checkInvalidKey": true,
        "checkSiteMap": true,
        "uploadWithSourceMap": true,
        "compileHotReLoad": true,
        "lazyloadPlaceholderEnable": false,
        "useMultiFrameRuntime": true,
        "useApiHook": true,
        "useApiHostProcess": true,
        "babelSetting": {
            "ignore": [],
            "disablePlugins": [],
            "outputPath": ""
        },
        "useIsolateContext": true,
        "userConfirmedBundleSwitch": false,
        "packNpmManually": false,
        "packNpmRelationList": [],
        "minifyWXSS": true,
        "disableUseStrict": false,
        "minifyWXML": true,
        "showES6CompileOption": false,
        "useCompilerPlugins": false,
        "ignoreUploadUnusedFiles": true
    },
    "compileType": "miniprogram",
    "libVersion": "2.19.4",
    "appid": "wxb2c7b1f97623094b",
    "projectname": "dome2",
    "debugOptions": {
        "hidedInDevtools": []
    },
    "scripts": {},
    "staticServerOptions": {
        "baseURL": "",
        "servePath": ""
    },
    "isGameTourist": false,
    "condition": {
        "search": {
            "list": []
        },
        "conversation": {
            "list": []
        },
        "game": {
            "list": []
        },
        "plugin": {
            "list": []
        },
        "gamePlugin": {
            "list": []
        },
        "miniprogram": {
            "list": []
        }
    }
}
```

## home.json

```json
{
  "usingComponents": {}
}
```

![image-20220226132955425](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220226132955425.png)

# 页面导航

什么是页面导航

页面导航指的是页面之间的相互跳转。例如，浏览器中实现页面导航的方式有如下两种：

```
<a href="www.baidu.com">白丢</a>
location.href
```

小程序中实现页面导航的两种方式

## 声明式导航

- 在页面上声明一个<navigator>：导航组件
- 通过点击<navigator>：组件实现页面跳转

## 编程式导航

- 调用小程序的导航AP！，实现页面的跳转

## 声明式导航

### 导航到tabBar页面

tabBar页面指的是被配置为tabBar的页面。

```
<view>
    <navigator url="/pages/home/home" open-type="switchTab">导航到首页</navigator>
</view>
```

### 导航到非tabBar页面

非tabBar页面指的是没有被配置为tabBar的页面。

在使用<navigator>：组件跳转到普通的非tabBar页面时，则需要指定url属性和open-type属性，其中：

- ul表示要跳转的页面的地址，必须以/开头
- open-type表示跳转的方式，必须为navigate

```
<view>
    <navigator url="/pages/info/info" open-type="navigate">到喊道info</navigator>
</view>
```

注意：为了简便，在导航到非tabBar页面时，open-type="navigate"属性可以省略。

```
<view>
    <navigator url="/pages/info/info">到喊道info</navigator>
</view>
```

### 后退导航

如果要后退到上一页面或多级页面，则需要指定open-type属性和delta属性，其中：

- open-type的值必须是navigateBack，表示要进行后退导航
- delta的值必须是数字，表示要后退的层级

```
<view>
    <navigator open-type="navigateBack" delta="1">后台</navigator>
</view>
```

## 编程式导航

### 导航到tabBar页面

调用wx.switchTab（Object object）方法，可以跳转到tabBar页面。其中Object参数对象的属性列表如下：

#### new.wxml

```html
<view>
    <button bindtap="btn1">跳转</button>
</view>
```

#### new.js

```js
// pages/news/news.js
Page({

    /**
     * 页面的初始数据
     */
    data: {

    },
    btn1(){
        wx.switchTab({
          url: "/pages/home/home",
        })
    },

})
```

### 导航到非tabBar页面

调用wx.navigateTo（Object object）方法，可以跳转到非tabBar的页面。其中Object参数对象的属性列表如下：

![image-20220226140637655](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220226140637655.png)

#### new.wxml

```html
<view>
    <button bindtap="btn2">跳转</button>
</view>
```

#### new.js

```js
// pages/news/news.js
Page({

    data: {

    },
    btn1(){
        wx.switchTab({
          url: "/pages/home/home",
        })
    },
    btn2(){
        wx.navigateTo({
          url: '/pages/info/info',
        })
    },

})
```

### 后退导航

调用wx.navigateBack（Object object）方法，可以返回上一页面或多级页面。其中Object参数对象可选的属性列表如下：

![image-20220226141022150](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220226141022150.png)

#### info.wxml

```html
<view>
    <button bindtap="btn3">后退</button>
</view>
```

#### info.js

```js
Page({

    /**
     * 页面的初始数据
     */
    data: {

    },
    btn3(){
        wx.navigateBack({
        })
    },
)}
```

## 导航传参

### 声明式导航传参

navigator组件的url属性用来指定将要跳转到的页面的路径。同时，路径的后面还可以携带参数：

- 参数与路径之间使用 ? 分隔
- 参数键与参数值用 = 相连
- 不同参数用 & 分隔

代码示例加下·

```html
<view>
    <navigator url="/pages/info/info?name=zs&age=20"></navigator>
</view>
```

### 编程式导航传参

调用wx.navigateTo（Object object）方法跳转页面时，也可以携带参数，代码示例如下：

```js
    btn4(){
        wx.navigateTo({
          url: "/pages/info/info?name=zs&gender=男",
        })
    },
```

### 在onLoad中接收导航参数

通过声明式导航传参或编程式导航传参所携带的参数，可以直接在oLod事件中直接获取到，示例代码如下：

```js
// pages/info/info.js
Page({
    /**
     * 页面的初始数据
     */
    data: {
        query:[]
    },
    btn3(){
        wx.navigateBack({
        })
    },
    /**
     * 生命周期函数--监听页面加载
     */
    onLoad: function (options) {
        this.setData({
            query:options
        })
    },

    /**
     * 生命周期函数--监听页面初次渲染完成
     */
    onReady: function () {

    },
})
```

![image-20220226150237201](C:\Users\move\AppData\Roaming\Typora\typora-user-images\image-20220226150237201.png)

# 下拉刷新事件

什么是下拉刷新

下拉刷新是移动端的专有名词，指的是通过手指在屏幕上的下拉滑动操作，从而重新加载页面数据的行为。

启用下拉刷新有两种方式：

## 全局开启下拉刷新

- 在app,json的window节点中，将enablePullDownRefresh设置为true

## 局部开启下拉刷新

- 在页面的，json配置文件中，将enablePullDownRefresh设置为true

在实际开发中，推荐使用第2种方式，为需要的页面单独开启下拉刷新的效果。

## 配置下拉刷新窗口的样式

在全局或页面的json配置文件中，通过backgroundColor和backgroundTextStyle来配置下拉刷新窗口的样式，其中：

- ●backgroundColor用来配置下拉刷新窗口的背景颜色，仅支持16进制的颜色值
- ●backgroundTextStyle用来配置下拉刷新loading的样式，仅支持dark和light

```
{
  "usingComponents": {},
  "enablePullDownRefresh": true,
  "backgroundColor": "#efef82"
}
```

## 监听页面的下拉刷新事件

在页面的，js文件中，通过onPullDownRefresh（）函数即可监听当前页面的下拉刷新事件。

```js
    /**
     * 页面相关事件处理函数--监听用户下拉动作
     */
    onPullDownRefresh: function () {
      console.log("用户下拉了");
     this.setData({
       cotun:0
     })
     wx.stopPullDownRefresh({})
    },
```

